<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script type="text/javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <input type="file" onchange="imFile(this)" />
    <div id="demo"></div>
    <script type="text/javascript">
        /*FileReader共有4种读取方法：
        1.readAsArrayBuffer(file)：将文件读取为ArrayBuffer。
        2.readAsBinaryString(file)：将文件读取为二进制字符串
        3.readAsDataURL(file)：将文件读取为Data URL
        4.readAsText(file, [encoding])：将文件读取为文本，encoding缺省值为'UTF-8'*/
        var workbook;//读取完成的数据
        var rABS = false; //是否将文件读取为二进制字符串

        function imFile(obj) {
            if(!obj.files) {
                return
            }
            var f = obj.files[0];
            var reader = new FileReader();
            reader.onload = function(e) {
                var data = e.target.result;
                if(rABS) {
                    workbook = XLSX.read(btoa(fixdata(data)), {//手动转化
                        type: 'base64'
                    });
                } else {
                    workbook = XLSX.read(data, {
                        type: 'binary'
                    });
                }
                //workbook.SheetNames[0]是获取Sheets中第一个Sheet的名字
                //workbook.Sheets[Sheet名]获取第一个Sheet的数据
                var a = eval(JSON.stringify( XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]])));
                console.log(a[0].test1)
            };
            if(rABS) {
                reader.readAsArrayBuffer(f);
            } else {
                reader.readAsBinaryString(f);
            }
        }
        function fixdata(data) { //文件流转BinaryString
            var o = "",
            l = 0,
            w = 10240;
            for(; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
            o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
            return o;
        }
    </script>
</body>
</html>