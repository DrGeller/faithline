<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>GIAS DEMO</title>
  <script type="text/javascript" src="./js/GIAS.js"></script>
  <script type="text/javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=53oVIOgmSIejwV7EfphPgTynOZbIiVYu"></script>
  <script src="./js/echarts-master/dist/echarts.js"></script>
  <script src="./js/echarts-master/dist/extension/bmap.js"></script>
  <style type="text/css">
    * {
      margin: 0px;
      padding: 0px;
      font-family: "微软雅黑";
      box-sizing: border-box;
    }

    body {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .mainContainer {
      position: absolute;
      width: 100%;
      height: 100%;
      left: 0px;
      top: 0px;
      background-color: #ececec;
      z-index: 0;
    }

    .mainContainer .uploadBox {
      position: absolute;
      width: 600px;
      height: 400px;
      left: 50%;
      top: 200px;
      background-color: #fafafa;
      margin-left: -300px;
      border: 2px solid #bf0f0f;
      z-index: 2;
    }

    .uploadBox::before {
      content: "";
      display: table;
    }

    .uploadBox .logo {
      position: relative;
      width: 100%;
      height: 100px;
      margin-top: 80px;
      line-height: 100px;
      vertical-align: middle;
      text-align: center;
      font-size: 24px;
      color: #181818;
    }

    .uploadBox .inputFile {
      position: relative;
      width: 400px;
      height: 50px;
      left: 50%;
      margin-left: -200px;
    }

    .inputFile .uploadButton {
      position: absolute;
      width: 100px;
      height: 30px;
      top: 50%;
      left: 50%;
      margin-top: -15px;
      margin-left: -50px;
      background-color: #bf0f0f;
      border-radius: 30px;
      line-height: 30px;
      vertical-align: middle;
      text-align: center;
      color: #ffffff;
      cursor: pointer;
    }

    .uploadButton:hover {
      background-color: #920000;
    }

    .mainContainer .filePreview {
      position: absolute;
      width: 1600px;
      height: 900px;
      left: 50%;
      top: 30px;
      margin-left: -800px;
      box-sizing: border-box;
      background-color: #fafafa;
      display: none;
      z-index: 1;
    }

    .filePreview .actionBar {
      position: absolute;
      width: 100%;
      height: 98px;
      top: 0px;
      border-bottom: 1px solid #bf0f0f;
    }

    .filePreview .actionBar .nextButton {
      position: absolute;
      width: 100px;
      height: 30px;
      right: 60px;
      top: 50%;
      margin-top: -15px;
      background-color: #bf0f0f;
      border-radius: 30px;
      line-height: 30px;
      vertical-align: middle;
      text-align: center;
      color: #ffffff;
      cursor: pointer;
    }

    .filePreview .actionBar .nextButton:hover {
      background-color: #920000;
    }

    .filePreview .tableContainer {
      position: absolute;
      width: 1580px;
      height: 802px;
      left: 10px;
      bottom: 0px;
      border-left: 1px solid #cecece;
      border-right: 1px solid #cecece;
    }

    .tableContainer table {
      position: absolute;
      width: 100%;
      height: 100%;
      border-collapse: collapse;
      line-height: 100%;
      vertical-align: middle;
    }

    table thead {
      width: 100%;
      height: 100px;
      top: 0px;
      left: 0px;
      border-bottom: 1px solid #cecece;
    }

    table thead tr th {
      width: 20%;
      height: 99px;
      text-align: left;
      padding-left: 4%;
      font-size: 24px;
      font-style: bold;
    }

    table thead tr th:last-child,
    table tbody tr td:last-child {
      width: 40%;
    }

    table tbody {
      position: absolute;
      width: 100%;
      height: 700px;
      left: 0px;
      top: 100px;
      overflow: auto;
    }

    table tbody tr:nth-of-type(odd) {
      background-color: #f8f8f8;
    }

    table tbody tr:nth-of-type(even) {
      background-color: #d6d6d6;
    }

    table tbody tr td {
      width: 20%;
      height: 35px;
      font-size: 14px;
      padding-left: 4%;
    }

    .mainContainer .mainView {
      position: absolute;
      width: 100%;
      height: 100%;
      left: 0px;
      top: 0px;
      display: none;
      z-index: 1;
    }

    .mainView .topLayout {
      width: 100%;
      height: 50%;
    }

    .topLayout .mapContainer {
      width: 100%;
      height: 100%;
      background-color: #ececec;
      border-bottom: 4px solid #bf0f0f;
    }

    .mainView .bottomView {
      width: 100%;
      height: 50%;
    }

    .bottomView .chartContainer {
      display: inline-block;
      width: 30%;
      height: 50%;
    }
  </style>

</head>

<body onload="stage01()">
  <div class="mainContainer">
    <div id="mainView" class="mainView">
      <div class="topLayout">
        <div id="mapContainer" class="mapContainer"></div>
      </div>
      <div class="bottomLayout">
        <div id="" class="chartContainer"></div>
        <div id="" class="chartContainer"></div>
        <div id="" class="chartContainer"></div>
      </div>
    </div>
    <div id="filePreview" class="filePreview">
      <div class="actionBar">
        <a href="" download="data.xlsx" id="hf"></a>
        <div id="nextButton" class="nextButton">下一步</div>
      </div>
      <div class="tableContainer">
        <table id="fileTable" class="fileTable"></table>
      </div>
    </div>
    <div id="uploadBox" class="uploadBox">
      <div class="logo">点击选择EXCEL文件</div>
      <div class="inputFile">
        <input id="fileSelector" type="file" style="position:absolute;opacity:0" />
        <div id="uploadButton" class="uploadButton">
          <span>选择</span>
        </div>
      </div>
    </div>
    <script type="text/javascript">
      var uploadBox = document.getElementById("uploadBox");
      var fileSelector = document.getElementById("fileSelector");
      var uploadButton = document.getElementById("uploadButton");
      var filePreview = document.getElementById("filePreview");
      var mianView = document.getElementById("mainView");
      var fileTable = document.getElementById("fileTable");
      var nextButton = document.getElementById("nextButton");

      function stage01() {
        uploadButton.onclick = function () {
          fileSelector.click();
        }
        fileSelector.onchange = function () {
          imFile(this);
        }
      }

      function stage02() {
        uploadBox.style.display = "none";
        filePreview.style.display = "block";
        displayTable();
      }

      function stage03() {
        nextButton.onclick = function () {
          filePreview.style.display = "none";
          mainView.style.display = "block";
          //getGeoInfo();
          //int = setInterval("getGeoInfo()",60000);
          var mapChart = echarts.init(document.getElementById('mapContainer'));
          mapChart.setOption({
            bmap: {
              center: [109.611067, 32.7782],
              zoom: 11,
              roam: true,
              mapStyle: {
                styleJson: [{
                  'featureType': 'land',     //调整土地颜色
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#081734'
                  }
                }, {
                  'featureType': 'building',   //调整建筑物颜色
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#04406F'
                  }
                }, {
                  'featureType': 'building',   //调整建筑物标签是否可视
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'highway',     //调整高速道路颜色
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#015B99'
                  }
                }, {
                  'featureType': 'highway',    //调整高速名字是否可视
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'arterial',   //调整一些干道颜色
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#003051'
                  }
                }, {
                  'featureType': 'arterial',
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'green',
                  'elementType': 'geometry',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'water',
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#044161'
                  }
                }, {
                  'featureType': 'subway',    //调整地铁颜色
                  'elementType': 'geometry.stroke',
                  'stylers': {
                    'color': '#003051'
                  }
                }, {
                  'featureType': 'subway',
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'railway',
                  'elementType': 'geometry',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'railway',
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'all',     //调整所有的标签的边缘颜色
                  'elementType': 'labels.text.stroke',
                  'stylers': {
                    'color': '#313131'
                  }
                }, {
                  'featureType': 'all',     //调整所有标签的填充颜色
                  'elementType': 'labels.text.fill',
                  'stylers': {
                    'color': '#FFFFFF'
                  }
                }, {
                  'featureType': 'manmade',
                  'elementType': 'geometry',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'manmade',
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'local',
                  'elementType': 'geometry',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'local',
                  'elementType': 'labels',
                  'stylers': {
                    'visibility': 'off'
                  }
                }, {
                  'featureType': 'subway',
                  'elementType': 'geometry',
                  'stylers': {
                    'lightness': -65
                  }
                }, {
                  'featureType': 'railway',
                  'elementType': 'all',
                  'stylers': {
                    'lightness': -40
                  }
                }, {
                  'featureType': 'boundary',
                  'elementType': 'geometry',
                  'stylers': {
                    'color': '#8b8787',
                    'weight': '1',
                    'lightness': -29
                  }
                }]
              }
            },
            series: [{
              type: 'scatter',
              coordinateSystem: 'bmap',
              data: [[120, 30, 1]]
            }]
          })
          var bmap = mapChart.getModel().getComponent('bmap').getBMap();
          bmap.addControl(new BMap.MapTypeControl());
        }
      }
    </script>
  </div>
</body>

</html>